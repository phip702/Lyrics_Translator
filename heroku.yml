setup:
  addons:
    - plan: heroku-postgresql
      as: DATABASE
    - plan: cloudamqp:lemur  # Add CloudAMQP for RabbitMQ
build:
  docker:
    web: Dockerfile
  config:
    FLASK_APP: app
    FLASK_ENV: production
    RABBITMQ_HOST: rabbitmq  # Set the RabbitMQ host environment variable
    DATABASE_URL: $DATABASE_URL  # Heroku's Postgres URL will be automatically provided

run:
  web: gunicorn -b 0.0.0.0:$PORT app:create_app
